# ğŸ’° MÃ“DULO FINANCEIRO - ESTRUTURA COMPLETA

## ğŸ“Š VISÃƒO GERAL DAS TABELAS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MÃ“DULO FINANCEIRO                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ financial_groups â”‚â—„â”€â”€â”€â”€â”   â”‚ dre_categories   â”‚             â”‚
â”‚  â”‚ (15 grupos)      â”‚     â”‚   â”‚ (20+ categorias) â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚         â–²                 â”‚            â–²                        â”‚
â”‚         â”‚                 â”‚            â”‚                        â”‚
â”‚         â”‚                 â”‚            â”‚                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚      financial_classes (PRINCIPAL)       â”‚                  â”‚
â”‚  â”‚  â€¢ Advogado                              â”‚                  â”‚
â”‚  â”‚  â€¢ Aluguel EscritÃ³rio                    â”‚                  â”‚
â”‚  â”‚  â€¢ CombustÃ­vel                           â”‚                  â”‚
â”‚  â”‚  â€¢ ComissÃ£o de Vendas                    â”‚                  â”‚
â”‚  â”‚  â€¢ ... (33+ classes)                     â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚         â–²                 â”‚            â–²                        â”‚
â”‚         â”‚                 â”‚            â”‚                        â”‚
â”‚         â”‚                 â”‚            â”‚                        â”‚
â”‚         â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ capital_flow_   â”‚              â”‚ financial_         â”‚        â”‚
â”‚  â”‚ categories      â”‚              â”‚ transactions       â”‚        â”‚
â”‚  â”‚ (7 categorias)  â”‚              â”‚ (movimentaÃ§Ãµes)    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                            â”‚                    â”‚
â”‚                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚                                   â”‚ financial_       â”‚           â”‚
â”‚                                   â”‚ budgets          â”‚           â”‚
â”‚                                   â”‚ (orÃ§amentos)     â”‚           â”‚
â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1ï¸âƒ£ FINANCIAL_GROUPS (Grupos)

**Exemplo de dados:**

| ID | Name | Description | Display Order |
|----|------|-------------|---------------|
| uuid-1 | SG&A | Selling, General & Administrative | 1 |
| uuid-2 | SÃ³cios | Despesas e operaÃ§Ãµes relacionadas a sÃ³cios | 2 |
| uuid-3 | Despesas Operacionais | Despesas operacionais gerais | 3 |
| uuid-4 | Marketing & Comercial | Despesas de marketing | 7 |
| uuid-5 | Estoque | MovimentaÃ§Ãµes de estoque | 5 |

**Total: 15 grupos**

```sql
-- Estrutura da Tabela
CREATE TABLE financial_groups (
    id UUID PRIMARY KEY,
    name VARCHAR(255) UNIQUE,      -- "SG&A", "SÃ³cios", etc
    description TEXT,
    display_order INTEGER,
    active BOOLEAN,
    created_at TIMESTAMP,
    updated_at TIMESTAMP,
    deleted_at TIMESTAMP
);
```

---

## 2ï¸âƒ£ DRE_CATEGORIES (Categorias DRE Gerencial)

**Exemplo de dados:**

| ID | Name | Category Type | Is Subtotal | Display Order |
|----|------|---------------|-------------|---------------|
| uuid-10 | Receita Bruta | revenue | false | 1 |
| uuid-11 | (-) Custo da Mercadoria Vendida (CMV) | expense | false | 2 |
| uuid-12 | (-) ComissÃµes | expense | false | 4 |
| uuid-13 | LUCRO BRUTO | calculation | **true** | 9 |
| uuid-14 | (-) Despesas Operacionais (SG&A) | expense | false | 10 |
| uuid-15 | EBIT (Lucro Operacional) | calculation | **true** | 13 |
| uuid-16 | Lucro LÃ­quido | calculation | **true** | 16 |

**Total: 20+ categorias para estruturar o DRE**

```sql
-- Estrutura da Tabela
CREATE TABLE dre_categories (
    id UUID PRIMARY KEY,
    name VARCHAR(255) UNIQUE,
    parent_id UUID REFERENCES dre_categories(id),
    category_type VARCHAR(50),     -- 'revenue', 'expense', 'calculation'
    formula TEXT,                  -- Para cÃ¡lculos (Lucro = Receita - Despesa)
    display_order INTEGER,
    is_subtotal BOOLEAN,           -- Para LUCRO BRUTO, EBIT, etc
    is_total BOOLEAN,              -- Para Lucro LÃ­quido final
    active BOOLEAN
);
```

---

## 3ï¸âƒ£ CAPITAL_FLOW_CATEGORIES (Batimento Capital)

**Exemplo de dados:**

| ID | Name | Flow Type | Display Order |
|----|------|-----------|---------------|
| uuid-20 | EXPENSE | outflow | 1 |
| uuid-21 | PURCHASE ORDER | outflow | 2 |
| uuid-22 | EmprÃ©stimo a terceiros | outflow | 3 |
| uuid-23 | DISTRIBUIÃ‡ÃƒO DE LUCRO | outflow | 4 |
| uuid-24 | Contas a Receber | inflow | 5 |
| uuid-25 | INCOME | inflow | 6 |

**Total: 7 categorias para fluxo de caixa**

```sql
-- Estrutura da Tabela
CREATE TABLE capital_flow_categories (
    id UUID PRIMARY KEY,
    name VARCHAR(255) UNIQUE,
    flow_type VARCHAR(50),         -- 'inflow', 'outflow', 'neutral'
    description TEXT,
    display_order INTEGER,
    active BOOLEAN
);
```

---

## 4ï¸âƒ£ FINANCIAL_CLASSES (â­ TABELA PRINCIPAL)

**Exemplo de dados completos:**

| Name | Grupo | DRE | Batimento Capital | Sub-categoria |
|------|-------|-----|-------------------|---------------|
| Advogado | SG&A | (-) Despesas Operacionais (SG&A) | EXPENSE | - |
| Aluguel EscritÃ³rio | SG&A | (-) Despesas Operacionais (SG&A) | EXPENSE | Office Expenses:Rent |
| CombustÃ­vel | Despesas Operacionais | (-) Despesas Operacionais (SG&A) | EXPENSE | Vehicle expenses:Vehicle gas & fuel |
| ComissÃ£o de Vendas | ComissÃ£o de Vendas | (-) ComissÃµes | EXPENSE | Commissions & fees |
| Compra de Produtos - Novos | Estoque | Estoque | PURCHASE ORDER | - |
| Frete de compra de mercadorias | CMV | (-) Frete de compra de mercadorias | EXPENSE | Office expenses:Shipping |
| Publicidade e marketing | Marketing & Comercial | (-) Despesas Operacionais (SG&A) | EXPENSE | Advertising & marketing |
| Retirada SÃ³cios | DISTRIBUIÃ‡ÃƒO DE LUCRO | DISTRIBUIÃ‡ÃƒO DE LUCRO | DISTRIBUIÃ‡ÃƒO DE LUCRO | - |
| SalÃ¡rio | SG&A | (-) Despesas Operacionais (SG&A) | EXPENSE | - |

**Total: 33+ classes financeiras**

```sql
-- Estrutura da Tabela
CREATE TABLE financial_classes (
    id UUID PRIMARY KEY,
    name VARCHAR(255),
    
    -- RELACIONAMENTOS (3 classificaÃ§Ãµes)
    group_id UUID REFERENCES financial_groups(id),
    dre_category_id UUID REFERENCES dre_categories(id),
    capital_flow_category_id UUID REFERENCES capital_flow_categories(id),
    
    -- DETALHES
    subcategory VARCHAR(255),      -- Ex: "Office Expenses:Rent"
    description TEXT,
    
    -- CONFIGURAÃ‡Ã•ES
    is_tax_deductible BOOLEAN,     -- DedutÃ­vel de impostos?
    requires_approval BOOLEAN,     -- Requer aprovaÃ§Ã£o?
    
    display_order INTEGER,
    active BOOLEAN,
    
    UNIQUE(name, group_id)
);
```

---

## 5ï¸âƒ£ FINANCIAL_TRANSACTIONS (MovimentaÃ§Ãµes)

**Exemplo de lanÃ§amento:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LANÃ‡AMENTO FINANCEIRO                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Data: 2026-01-15                                               â”‚
â”‚ Classe Financeira: "Aluguel EscritÃ³rio"                        â”‚
â”‚   â”œâ”€ Grupo: SG&A                                               â”‚
â”‚   â”œâ”€ DRE: (-) Despesas Operacionais (SG&A)                     â”‚
â”‚   â”œâ”€ Batimento: EXPENSE                                        â”‚
â”‚   â””â”€ Sub-categoria: Office Expenses:Rent                       â”‚
â”‚                                                                â”‚
â”‚ DescriÃ§Ã£o: "Aluguel Janeiro 2026"                             â”‚
â”‚ Valor: -$2,500.00                                              â”‚
â”‚ Tipo: expense (despesa)                                        â”‚
â”‚ Status: paid (pago)                                            â”‚
â”‚ Fornecedor: Real Estate Company                                â”‚
â”‚ MÃ©todo Pagamento: bank_transfer                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```sql
-- Estrutura da Tabela
CREATE TABLE financial_transactions (
    id UUID PRIMARY KEY,
    financial_class_id UUID REFERENCES financial_classes(id),
    
    -- DADOS DA TRANSAÃ‡ÃƒO
    transaction_date DATE,
    description TEXT,
    amount DECIMAL(15, 2),
    transaction_type VARCHAR(20),  -- 'income', 'expense'
    
    -- REFERÃŠNCIAS
    agent_id UUID,                 -- Fornecedor/Cliente
    invoice_number VARCHAR(100),
    payment_method VARCHAR(50),
    
    -- STATUS
    status VARCHAR(50),            -- 'pending', 'approved', 'paid'
    approved_by UUID,
    approved_at TIMESTAMP,
    paid_at TIMESTAMP,
    
    -- EXTRAS
    notes TEXT,
    attachments JSONB,
    
    -- RECORRÃŠNCIA
    is_recurring BOOLEAN,
    recurrence_rule TEXT,
    
    created_by UUID,
    created_at TIMESTAMP
);
```

---

## 6ï¸âƒ£ FINANCIAL_BUDGETS (OrÃ§amentos)

**Exemplo:**

| Classe Financeira | Ano | MÃªs | Valor OrÃ§ado | ObservaÃ§Ãµes |
|-------------------|-----|-----|--------------|-------------|
| Aluguel EscritÃ³rio | 2026 | 1 | $2,500.00 | Aluguel fixo mensal |
| CombustÃ­vel | 2026 | 1 | $800.00 | Estimativa baseada em histÃ³rico |
| Marketing | 2026 | NULL | $30,000.00 | OrÃ§amento anual |

```sql
-- Estrutura da Tabela
CREATE TABLE financial_budgets (
    id UUID PRIMARY KEY,
    financial_class_id UUID REFERENCES financial_classes(id),
    
    year INTEGER,
    month INTEGER,                 -- NULL para orÃ§amento anual
    
    budgeted_amount DECIMAL(15, 2),
    notes TEXT,
    
    created_by UUID,
    created_at TIMESTAMP,
    
    UNIQUE(financial_class_id, year, month)
);
```

---

## ğŸ“ˆ COMO OS DADOS SE CONECTAM

### Exemplo: LanÃ§amento de "Aluguel EscritÃ³rio"

```
1. UsuÃ¡rio lanÃ§a uma despesa
   â†“
2. Seleciona Classe: "Aluguel EscritÃ³rio"
   â†“
3. Sistema automaticamente associa:
   â”œâ”€ Grupo: "SG&A"
   â”œâ”€ DRE: "(-) Despesas Operacionais (SG&A)"
   â”œâ”€ Batimento: "EXPENSE"
   â””â”€ Sub-categoria: "Office Expenses:Rent"
   â†“
4. TransaÃ§Ã£o Ã© salva em financial_transactions
   â†“
5. RelatÃ³rios (DRE, Batimento, ApuraÃ§Ã£o) leem automaticamente
```

---

## ğŸ“Š RELATÃ“RIOS GERADOS

### 1. **DRE GERENCIAL (Mensal)**
```
DEMONSTRAÃ‡ÃƒO DO RESULTADO DO EXERCÃCIO - JANEIRO 2026

Receita Bruta                          $628,956
(-) Custo da Mercadoria Vendida        ($554,736)
(-) ComissÃµes                          ($8,978)
(-) Frete de compra                    ($249)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
LUCRO BRUTO                            $64,992

(-) Despesas Operacionais (SG&A)       ($20,109)
(-) ParticipaÃ§Ã£o nos Resultados        ($1,122)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
EBIT (Lucro Operacional)               $43,761

Lucro LÃ­quido                          $43,761
Lucro LÃ­quido %                        6.96%
```

### 2. **BATIMENTO CAPITAL**
```
FLUXO DE CAIXA - JANEIRO 2026

CONTAS A RECEBER
  Receita de vendas                    $49,881,636

EXPENSE (SaÃ­das)
  Pagamentos recebidos                 ($63,349,682)
  Aluguel                              ($2,500)
  SalÃ¡rios                             ($15,000)
  ...

ESTOQUE
  Estoque fÃ­sico (Entrada - Pago)      $X
  ...
```

### 3. **APURAÃ‡ÃƒO SEMANAL**
```
APURAÃ‡ÃƒO SEMANAL - Semana 2 (04/01 a 10/01)

RECEITA                                $628,956.12
CUSTO OP                               ($554,736.83)
LUCRO BRUTO                            $74,219.29
MARGEM BRUTA                           11.80%

ProvisÃ£o de ComissÃ£o                   ($8,978.19)
Despesas                               ($13,613.43)
ParticipaÃ§Ã£o nos Resultados            ($1,290.70)

Resultado LÃ­quido da Semana            $50,337.46
MARGEM LÃQUIDA                         8.00%
```

---

## ğŸ” SEGURANÃ‡A (RLS)

- âœ… Todos os usuÃ¡rios autenticados podem **LER** dados financeiros
- âœ… Apenas **ADMINS** podem criar/editar **cadastros** (grupos, classes, categorias)
- âœ… Qualquer usuÃ¡rio pode **LANÃ‡AR** transaÃ§Ãµes
- âœ… Apenas **ADMINS** ou **CRIADOR** podem editar transaÃ§Ãµes
- âœ… Apenas **ADMINS** podem gerenciar orÃ§amentos

---

## ğŸ“ RESUMO DOS NÃšMEROS

| Tabela | Quantidade Inicial |
|--------|-------------------|
| Financial Groups | 15 grupos |
| DRE Categories | 20+ categorias |
| Capital Flow Categories | 7 categorias |
| **Financial Classes** | **33+ classes** |
| Transactions | 0 (a ser lanÃ§ado) |
| Budgets | 0 (a ser criado) |

---

## âœ… PRÃ“XIMOS PASSOS

1. âœ… Aplicar migrations no banco
2. ğŸ”„ Criar pÃ¡ginas de **Cadastro**
3. ğŸ”„ Criar pÃ¡gina de **LanÃ§amentos**
4. ğŸ”„ Criar **RelatÃ³rios** (DRE, Batimento, ApuraÃ§Ã£o)
